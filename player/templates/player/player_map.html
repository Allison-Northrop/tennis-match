<!DOCTYPE html>
{% extends 'player/base.html' %}

<html>
{% block content %}
<head>
<style>
#map {
  height: 590px;
  width: 100%;
}
</style>
</head>
<body>
  <div>


    <h3> something else after the for loop</h3>
  </div>
  <!-- loop through and convert to latitutde and longitude for all addresses. then when the list is made, loop through it   -->
  <div id="map"></div>

  <script>
  var map_players = []

  "{% for player in players %}"
  map_players.push( {id: "{{player.id}}", username: "{{player.username}}", skill_level: "{{player.skill_level}}", address: "{{player.address}}", availability_days: "{{player.availability_days}}", availability_times: "{{player.availability_times}}", looking_for: "{{player.availability_days}}", phone_number: "{{player.phone_number}}", email: "{{player.email}}", additional_info: "{{player.additional_info}}", latitude: "{{player.latitude}}", longitude: "{{player.longitude}}" })
  "{% endfor %}"
  console.log(map_players)

  // console.log(map_players)
  // var coordinates = {}
  // for (i = 0; i < map_players.length; i++) {
  //     for (i = 0; i < map_players.[i]["address"]; i ++) {
  // }

  function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 4,
      center: {lat: 47.608013, lng: -122.335167}
    });

    var infoWindow = new google.maps.InfoWindow;
    var infowincontent = document.createElement('div');
    var strong = document.createElement('strong');
    strong.textContent = name
    infowincontent.appendChild(strong);
    infowincontent.appendChild(document.createElement('br'));

    var text = document.createElement('text');
    text.textContent = map_players[2]
    infowincontent.appendChild(text);
  

    for (i = 0; i < map_players.length; i++) {
      console.log(parseFloat(map_players[i]["latitude"])) //coverting into float
      console.log(parseFloat(map_players[i]["longitude"]))
      var marker = new google.maps.Marker({
        position: {lat: parseFloat(map_players[i]["latitude"]), lng: parseFloat(map_players[i]["longitude"])},
        map: map
      });

      marker.addListener('click', function() {
        console.log("clicked the marker")
        infoWindow.setContent(infowincontent);
        infoWindow.open(map, marker);
      })
    }
  }


  </script>

  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key={{GOOGLE_API_KEY}}&callback=initMap">
  </script>
</body>
{% endblock %}
</html>
